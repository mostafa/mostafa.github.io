<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Beginner’s Guide to Load Testing with k6 - Mostafa’s personal blog</title>
<meta name="description" content="Part 2 — Performance Goals and k6 Metrics ">


  <meta name="author" content="Mostafa Moradian">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Mostafa's personal blog">
<meta property="og:title" content="Beginner’s Guide to Load Testing with k6">
<meta property="og:url" content="https://medium.com/swlh/beginners-guide-to-load-testing-with-k6-73d55ee23723">


  <meta property="og:description" content="Part 2 — Performance Goals and k6 Metrics ">





  <meta name="twitter:site" content="@mosimoradian">
  <meta name="twitter:title" content="Beginner’s Guide to Load Testing with k6">
  <meta name="twitter:description" content="Part 2 — Performance Goals and k6 Metrics ">
  <meta name="twitter:url" content="https://medium.com/swlh/beginners-guide-to-load-testing-with-k6-73d55ee23723">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2019-06-19T00:00:00+02:00">






<link rel="canonical" href="https://medium.com/swlh/beginners-guide-to-load-testing-with-k6-73d55ee23723">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Mostafa Moradian",
      "url": "https://mostafa.dev/",
      "sameAs": ["https://twitter.com/MosiMoradian","https://instagram.com/mostafa_moradian","https://www.linkedin.com/in/mostafa-moradian","https://www.medium.com/@mostafamoradian","https://www.github.com/mostafa"]
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Mostafa's personal blog Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--posts">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/img/avatar.jpeg" alt=""></a>
        
        <a class="site-title" href="/">
          Mostafa's personal blog
          <span class="site-subtitle">Version 0.0.5</span>
        </a>
        <ul class="visible-links"></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  


  <div class="archive">
    
      <h1 id="page-title" class="page__title">Beginner’s Guide to Load Testing with k6</h1>
    
    <p>Performance testing is an umbrella term for a group of tests that encompasses many types of tests, as discussed in <a href="https://medium.com/swlh/beginners-guide-to-load-testing-with-k6-85ec614d2f0d">the first part of this series</a>. Each test type tries to answer a set of questions to make the performance testing process more goal-oriented. This means that just running tests is not enough, you have to have a set of goals to reach.</p>

<p>Since we’re testing an API or a website, the following goals may be relevant, in which you can choose either one or more:</p>

<ul>
  <li><strong>Concurrency</strong>: systems which would set this goal, usually have a concept of end-user and need to see how the system behaves while many concurrent users try to access the system. They basically want to test how many of requests fail/pass under high loads of users. This both includes many concurrent users and each requesting multiple resources at the same time.</li>
  <li><strong>Throughput</strong>: systems with no concept of end-users, would set this goal to see how the system behaves overall, while there is a ton of requests/responses coming in/out of the system.</li>
  <li><strong>Server response time</strong>: this goal signifies the time it takes from the initial request from the client to the server up until a response is sent back from the server.</li>
  <li><strong>Regression testing</strong>: sometimes the goal is not to put “heavy load” on the system, but is more about “normal load” and functional and regression testing to see how a change would affect our system’s performance and if it still adheres to our defined SLAs.
The general idea is to measure how a system or system of systems behave(s) under heavy load, in terms of speed, scalability, stability and resiliency. Each of which can be measured by these goals.</li>
</ul>

<ol>
  <li><em>*Speed</em> ***can be measured by time it takes for request to be handled by the server and how much time it takes for this request/response to happen.</li>
  <li><strong>Scalability</strong> can be measured by how well the system scales if the load is increased and by measuring if it sustains over a period of time under this load.</li>
  <li><strong>Stability</strong> can be measured by how well the system sustains the load and to see if it stands against a high number of errors and events and still stays responsive and stable.</li>
  <li>**Resiliency **can be measured by how the system recovers from crashes and down-times and responds to requests, after putting too much or too frequent load on it and eventually crashing the system.
    <h4 id="rerunning-tests-to-verify-the-results">Rerunning Tests to Verify the Results</h4>
  </li>
</ol>

<p>You can rerun the tests to see if they hold almost the same results during different tests and compare the tests to see if they deviate.</p>

<p>If they are almost the same, you can analyze the tests and derive your results, otherwise you should pinpoint where it deviates and try to find a way to prevent it from happening, like a bottleneck.</p>

<h4 id="k6-and-the-metrics"><strong>k6 and the Metrics</strong></h4>

<p>k6 supports a set of built-in and custom metrics that can be used to measure various things and to either achieve the above mentioned goals or prove them wrong. The metrics that can be used to define custom metrics are: <a href="https://docs.k6.io/docs/counter-k6metrics">Counter</a>, <a href="https://docs.k6.io/docs/gauge-k6metrics">Gauge</a>, <a href="https://docs.k6.io/docs/rate-k6metrics">Rate</a> and <a href="https://docs.k6.io/docs/trend-k6metrics">Trend</a>.</p>

<p><img src="/img/1*4vdPNtvMGfnuls5_7rG8mQ.png" alt="" />k6 built-in metricsAs you’ve probably seen above, these following tables describes reported built-in metrics, present on all tests:</p>

<p>k6 built-in metrics, <strong>Credits</strong>: <a href="https://docs.k6.io/docs/result-metrics#section-built-in-metrics">https://docs.k6.io/docs/result-metrics#section-built-in-metrics</a>k6 HTTP-specific built-in metrics, <strong>Credits</strong>: <a href="https://docs.k6.io/docs/result-metrics#section-http-specific-built-in-metrics">https://docs.k6.io/docs/result-metrics#section-http-specific-built-in-metrics</a>#### Custom (non-built-in) Metrics</p>

<h4 id="1-counter">1. Counter</h4>

<p>This is a simple cumulative counter that can be used to measure any cumulative value like number of errors during the test.</p>

<p>k6 Counter metricAs you can see in the above example, it counts the number of 404 errors that are returned by the test. The result is evident in the screenshot below:</p>

<p><img src="/img/1*caIiiiUAjcSD49mVuBGJfA.png" alt="" />Results of k6 Counter metricSince it is a beginner’s guide, I try to stick with simple examples, but you can extend and customize them to your specific case.</p>

<h4 id="2-gauge">2. Gauge</h4>

<p>This metric lets you keep the last thing that is added to it. It’s a simple over-writable metric that holds its last added value.</p>

<p>This metric can be used to retain the last value of any test item, be it response time, delay or any other user-defined value.</p>

<p>If you run the following code, you’ll see that it catches the latest error code, which is 404.</p>

<p>k6 Gauge metricThe result of the test is presented in the screenshot below.</p>

<p><img src="/img/1*i1cKpSpRMgjMy9wg_-eZ1Q.png" alt="" />Results of k6 Gauge metric#### 3. Rate</p>

<p>This built-in metric keeps the rate between non-zero and zero/false values. For example if you add two false and one true value, the percentage becomes 33%.</p>

<p>It can be used to keep track of the rate of successful request/responses and compare them with errors.</p>

<p>In the following piece of code, you can see that I added res.error_code as a measure to see how many errors I’ll catch.</p>

<p>k6 Rate metricBelow is the result of the test, which is 100% errors.</p>

<p><img src="/img/1*OiuMqAnYlA_Ir-oLZK61xg.png" alt="" />Results of k6 Rate metric#### 4. Trend</p>

<p>This metric allows you to statistically calculate your custom value. It will give you minimum, maximum, average and percentiles, as is evident in the above screenshots for http_req* requests.</p>

<p>k6 Rate metricThe above example of rate metric shows how to calculate the sending and receiving time without taking into account the waiting time. The result is shown below:</p>

<p><img src="/img/1*Ls79S9pcf_T5xKEPvh_qrA.png" alt="" />Results of k6 Rate metricIn this part, I’ve tried to describe the goals of performance testing and how one can use metrics to achieve those goals. In the next sections, I’ll try to go more in-depth and present you more details on how to define custom metrics and how to use them.</p>

<p>Now that you have a good grasp of performance goals and k6 metrics, you can move to <a href="https://medium.com/swlh/beginners-guide-to-load-testing-with-k6-ff155885b6db">the next article</a>, in which I try to show you how to write and run a k6 script.</p>


<ul class="taxonomy__index">
  
  
    <li>
      <a href="#2020">
        <strong>2020</strong> <span class="taxonomy__count">3</span>
      </a>
    </li>
  
    <li>
      <a href="#2019">
        <strong>2019</strong> <span class="taxonomy__count">10</span>
      </a>
    </li>
  
    <li>
      <a href="#2018">
        <strong>2018</strong> <span class="taxonomy__count">1</span>
      </a>
    </li>
  
</ul>



  <section id="2020" class="taxonomy__section">
    <h2 class="archive__subtitle">2020</h2>
    <div class="entries-list">
      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/devrel-content-strategies" rel="permalink">DevRel Content Strategies
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">The very first developer relations online meetup of Stockholm was streamed live on Facebook on April 15, 2020. It was also recorded and later published on Yo...</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/load-testing-your-api-with-postman" rel="permalink">Load Testing Your API with Postman
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">In this article, I’ll explain how to use a Postman collection I have created to load test our instance of our test API. The process is pretty straightforward...</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/load-testing-your-api-with-swagger-openapi-and-k6" rel="permalink">Load Testing Your API with Swagger/OpenAPI and k6
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Generating k6 scripts from Swagger/OpenAPI specifications has never been easier. Using the newly built k6 generator, you can convert your API specification t...</p>
  </article>
</div>

      
    </div>
    <a href="#page-title" class="back-to-top">Back to Top &uarr;</a>
  </section>

  <section id="2019" class="taxonomy__section">
    <h2 class="archive__subtitle">2019</h2>
    <div class="entries-list">
      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/microvm-another-level-of-abstraction-for-serverless-computing" rel="permalink">microVM: Another Level of Abstraction for Serverless Computing
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">For years, cloud computing was a way to convince users and business to spend their money hosting their services on servers collocated on cloud data-centers. ...</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/api-backend-security" rel="permalink">API &amp; Backend Security
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">In my previous article about secure code review and penetration testing of Node.js and JavaScript apps, I tried to give the reader an introduction to the old...</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/integrating-k6-with-apache-kafka" rel="permalink">Integrating k6 with Apache Kafka
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Undoubtedly, Apache Kafka is one of the most prominent pieces of software existing in today’s distributed architectures, from cloud-providers supporting it t...</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/migration-of-old-projects-to-python-3" rel="permalink">Migration of Old Projects to Python 3
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">A while ago I’ve self-assigned the daunting task of migrating an ancient API project written in Python 2.7 and Django to the latest stable Python 3.7 and Dja...</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/employment-contract" rel="permalink">Employment Contract
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Disclaimer:
</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/beginner-s-guide-to-load-testing-with-k6-part-3" rel="permalink">Beginner’s Guide to Load Testing with k6
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Now that you know the basics and have defined your performance goals, it is now time to write your load-test script and run it using k6. Since k6 scripts can...</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/beginner-s-guide-to-load-testing-with-k6-part-2" rel="permalink">Beginner’s Guide to Load Testing with k6
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Performance testing is an umbrella term for a group of tests that encompasses many types of tests, as discussed in the first part of this series. Each test t...</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/beginner-s-guide-to-load-testing-with-k6-part-1" rel="permalink">Beginner’s Guide to Load Testing with k6
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Update: This article is part of a series on load testing. I will try to regularly publish related topics in this series. I won’t repeat this table of content...</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/secure-code-review-and-penetration-testing-of-node-js-and-javascript-apps" rel="permalink">Secure Code Review and Penetration Testing of Node.js and JavaScript Apps
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Security is an illusion and being secure is a relative matter. This means you should always have an eye on your security from any perspective: Physical, huma...</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/the-story-of-farhang-a-bilingual-dictionary-production-system" rel="permalink">The Story of Farhang, A Bilingual Dictionary Production System
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">More than 9 years ago, when I was studying towards a B.A. degree in German Language Translation Studies, I used to know and be a student of a great professor...</p>
  </article>
</div>

      
    </div>
    <a href="#page-title" class="back-to-top">Back to Top &uarr;</a>
  </section>

  <section id="2018" class="taxonomy__section">
    <h2 class="archive__subtitle">2018</h2>
    <div class="entries-list">
      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/the-story-of-grest-a-graph-based-restful-api-development-framework" rel="permalink">The Story of gREST, A Graph-based Restful API Development Framework
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">More than a year ago, I was looking for a framework to build my services with which can support graph-based databases, namely Neo4j, and give me the freedom ...</p>
  </article>
</div>

      
    </div>
    <a href="#page-title" class="back-to-top">Back to Top &uarr;</a>
  </section>


  </div>
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://mostafa.dev" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Mostafa.DEV</a></li>
        
      
        
          <li><a href="https://twitter.com/mosimoradian" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/mostafa" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://instagram.com/mostafa_moradian" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/mostafa-moradian" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://www.medium.com/@mostafamoradian" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-medium" aria-hidden="true"></i> Medium</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Mostafa Moradian. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-167412694-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-167412694-1', { 'anonymize_ip': false});
</script>









  </body>
</html>

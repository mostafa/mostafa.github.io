<!DOCTYPE html>
<html>

  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Beginner’s Guide to Load Testing with k6</title>
    <meta name="description" content="Performance testing is an umbrella term for a group of tests that encompasses many types of tests, as discussed in the first part of this series. Each test t...">

    
    
    <link rel="stylesheet" href="https://mostafa.dev/assets/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
    <link rel="canonical" href="https://mostafa.dev/blog/beginner-s-guide-to-load-testing-with-k6-part-2">
    <link rel="alternate" type="application/rss+xml" title="Mostafa's personal blog" href="https://mostafa.dev/feed.xml">

    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Beginner’s Guide to Load Testing with k6 | Mostafa’s personal blog</title>
<meta name="generator" content="Jekyll v4.0.1">
<meta property="og:title" content="Beginner’s Guide to Load Testing with k6">
<meta property="og:locale" content="en_US">
<meta name="description" content="Part 2 — Performance Goals and k6 Metrics">
<meta property="og:description" content="Part 2 — Performance Goals and k6 Metrics">
<link rel="canonical" href="https://mostafa.dev/blog/beginner-s-guide-to-load-testing-with-k6-part-2">
<meta property="og:url" content="https://mostafa.dev/blog/beginner-s-guide-to-load-testing-with-k6-part-2">
<meta property="og:site_name" content="Mostafa’s personal blog">
<meta property="og:image" content="https://mostafa.dev/img/1*PGbRNYX0UqKvho2X0ROzAg.png">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-06-19T00:00:00+02:00">
<script type="application/ld+json">
{"@type":"BlogPosting","url":"https://mostafa.dev/blog/beginner-s-guide-to-load-testing-with-k6-part-2","headline":"Beginner’s Guide to Load Testing with k6","dateModified":"2019-06-19T00:00:00+02:00","datePublished":"2019-06-19T00:00:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mostafa.dev/blog/beginner-s-guide-to-load-testing-with-k6-part-2"},"image":"https://mostafa.dev/img/1*PGbRNYX0UqKvho2X0ROzAg.png","description":"Part 2 — Performance Goals and k6 Metrics","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <style>
        body {
            font-family: 'Ubuntu', sans-serif;
            font-size: 16px;
            line-height: 2;
            color: #181818;
            background-color: #fff;
        }

        .subtitle {
            color: rgba(0, 0, 0, 0.54) !important;
        }
    </style>
</head>

  <body>

    <header class="border-bottom-thick px-2 clearfix">
  <div class="left sm-width-full py-1 mt-1 mt-lg-0">
    <a class="align-middle link-primary text-accent" href="/">
      Mostafa's personal blog
    </a>
  </div>
  <div class="right sm-width-full">
    <ul class="list-reset mt-lg-1 mb-2 mb-lg-1">
      
        
      
        
        <li class="inline-block">
          <a class="align-middle link-primary mr-2 mr-lg-0 ml-lg-2" href="/about/">
            About
          </a>
        </li>
        
      
        
      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</header>


    <div>
      <article class="container px-2 mx-auto mb4" itemscope itemtype="http://schema.org/BlogPosting">
    <h1 class="h1 col-9 sm-width-full mt-3 mb-0 pb-0 inline-block" itemprop="name headline">Beginner’s Guide to Load Testing with k6</h1>
    
        <h3 class="h3 col-9 sm-width-full mb-0 mt-0 inline-block subtitle" itemprop="name headline">Part 2 — Performance Goals and k6 Metrics
        </h3>
    
    
        <img class="col-12" src="/img/1*PGbRNYX0UqKvho2X0ROzAg.png">
    
    <div class="col-3 sm-width-full mt-1 border-top-thin ">
        <p class="mb-3 py-2 h4">
            <time datetime="2019-06-19T00:00:00+02:00" itemprop="datePublished">Jun 19, 2019</time>
        </p>
    </div>

    <div class="prose" itemprop="articleBody">
        <p>Performance testing is an umbrella term for a group of tests that encompasses many types of tests, as discussed in <a href="https://medium.com/swlh/beginners-guide-to-load-testing-with-k6-85ec614d2f0d">the first part of this series</a>. Each test type tries to answer a set of questions to make the performance testing process more goal-oriented. This means that just running tests is not enough, you have to have a set of goals to reach.</p>

<p>Since we’re testing an API or a website, the following goals may be relevant, in which you can choose either one or more:</p>

<ul>
  <li>
<strong>Concurrency</strong>: systems which would set this goal, usually have a concept of end-user and need to see how the system behaves while many concurrent users try to access the system. They basically want to test how many of requests fail/pass under high loads of users. This both includes many concurrent users and each requesting multiple resources at the same time.</li>
  <li>
<strong>Throughput</strong>: systems with no concept of end-users, would set this goal to see how the system behaves overall, while there is a ton of requests/responses coming in/out of the system.</li>
  <li>
<strong>Server response time</strong>: this goal signifies the time it takes from the initial request from the client to the server up until a response is sent back from the server.</li>
  <li>
<strong>Regression testing</strong>: sometimes the goal is not to put “heavy load” on the system, but is more about “normal load” and functional and regression testing to see how a change would affect our system’s performance and if it still adheres to our defined SLAs.
The general idea is to measure how a system or system of systems behave(s) under heavy load, in terms of speed, scalability, stability and resiliency. Each of which can be measured by these goals.</li>
</ul>

<ol>
  <li>
<em>*Speed</em> ***can be measured by time it takes for request to be handled by the server and how much time it takes for this request/response to happen.</li>
  <li>
<strong>Scalability</strong> can be measured by how well the system scales if the load is increased and by measuring if it sustains over a period of time under this load.</li>
  <li>
<strong>Stability</strong> can be measured by how well the system sustains the load and to see if it stands against a high number of errors and events and still stays responsive and stable.</li>
  <li>**Resiliency **can be measured by how the system recovers from crashes and down-times and responds to requests, after putting too much or too frequent load on it and eventually crashing the system.
    <h4 id="rerunning-tests-to-verify-the-results">Rerunning Tests to Verify the Results</h4>
  </li>
</ol>

<p>You can rerun the tests to see if they hold almost the same results during different tests and compare the tests to see if they deviate.</p>

<p>If they are almost the same, you can analyze the tests and derive your results, otherwise you should pinpoint where it deviates and try to find a way to prevent it from happening, like a bottleneck.</p>

<h4 id="k6-and-the-metrics"><strong>k6 and the Metrics</strong></h4>

<p>k6 supports a set of built-in and custom metrics that can be used to measure various things and to either achieve the above mentioned goals or prove them wrong. The metrics that can be used to define custom metrics are: <a href="https://docs.k6.io/docs/counter-k6metrics">Counter</a>, <a href="https://docs.k6.io/docs/gauge-k6metrics">Gauge</a>, <a href="https://docs.k6.io/docs/rate-k6metrics">Rate</a> and <a href="https://docs.k6.io/docs/trend-k6metrics">Trend</a>.</p>

<p><img src="/img/1*4vdPNtvMGfnuls5_7rG8mQ.png" alt="">k6 built-in metricsAs you’ve probably seen above, these following tables describes reported built-in metrics, present on all tests:</p>

<p>k6 built-in metrics, <strong>Credits</strong>: <a href="https://docs.k6.io/docs/result-metrics#section-built-in-metrics">https://docs.k6.io/docs/result-metrics#section-built-in-metrics</a>k6 HTTP-specific built-in metrics, <strong>Credits</strong>: <a href="https://docs.k6.io/docs/result-metrics#section-http-specific-built-in-metrics">https://docs.k6.io/docs/result-metrics#section-http-specific-built-in-metrics</a>#### Custom (non-built-in) Metrics</p>

<h4 id="1-counter">1. Counter</h4>

<p>This is a simple cumulative counter that can be used to measure any cumulative value like number of errors during the test.</p>

<p>k6 Counter metricAs you can see in the above example, it counts the number of 404 errors that are returned by the test. The result is evident in the screenshot below:</p>

<p><img src="/img/1*caIiiiUAjcSD49mVuBGJfA.png" alt="">Results of k6 Counter metricSince it is a beginner’s guide, I try to stick with simple examples, but you can extend and customize them to your specific case.</p>

<h4 id="2-gauge">2. Gauge</h4>

<p>This metric lets you keep the last thing that is added to it. It’s a simple over-writable metric that holds its last added value.</p>

<p>This metric can be used to retain the last value of any test item, be it response time, delay or any other user-defined value.</p>

<p>If you run the following code, you’ll see that it catches the latest error code, which is 404.</p>

<p>k6 Gauge metricThe result of the test is presented in the screenshot below.</p>

<p><img src="/img/1*i1cKpSpRMgjMy9wg_-eZ1Q.png" alt="">Results of k6 Gauge metric#### 3. Rate</p>

<p>This built-in metric keeps the rate between non-zero and zero/false values. For example if you add two false and one true value, the percentage becomes 33%.</p>

<p>It can be used to keep track of the rate of successful request/responses and compare them with errors.</p>

<p>In the following piece of code, you can see that I added res.error_code as a measure to see how many errors I’ll catch.</p>

<p>k6 Rate metricBelow is the result of the test, which is 100% errors.</p>

<p><img src="/img/1*OiuMqAnYlA_Ir-oLZK61xg.png" alt="">Results of k6 Rate metric#### 4. Trend</p>

<p>This metric allows you to statistically calculate your custom value. It will give you minimum, maximum, average and percentiles, as is evident in the above screenshots for http_req* requests.</p>

<p>k6 Rate metricThe above example of rate metric shows how to calculate the sending and receiving time without taking into account the waiting time. The result is shown below:</p>

<p><img src="/img/1*Ls79S9pcf_T5xKEPvh_qrA.png" alt="">Results of k6 Rate metricIn this part, I’ve tried to describe the goals of performance testing and how one can use metrics to achieve those goals. In the next sections, I’ll try to go more in-depth and present you more details on how to define custom metrics and how to use them.</p>

<p>Now that you have a good grasp of performance goals and k6 metrics, you can move to <a href="https://medium.com/swlh/beginners-guide-to-load-testing-with-k6-ff155885b6db">the next article</a>, in which I try to show you how to write and run a k6 script.</p>

    </div>

</article>

<div class="container mx-auto px-2 py-2 clearfix">
    <!-- Use if you want to show previous and next for all posts. -->



  <div class="col-4 sm-width-full left mr-lg-4 mt-3">
    <a class="no-underline border-top-thin py-1 block" href="https://mostafa.dev/blog/beginner-s-guide-to-load-testing-with-k6-part-1">
      <span class="h5 bold text-accent">Previous</span>
      <p class="bold h3 link-primary mb-1">Beginner’s Guide to Load Testing with k6</p>
      <p>Update: This article is part of a series on load testing. I will try to regularly publish related topics in...</p>
    </a>
  </div>
  
  
  <div class="col-4 sm-width-full left mt-3">
    <a class="no-underline border-top-thin py-1 block" href="https://mostafa.dev/blog/beginner-s-guide-to-load-testing-with-k6-part-3">
      <span class="h5 bold text-accent">Next</span>
      <p class="bold h3 link-primary mb-1">Beginner’s Guide to Load Testing with k6</p>
      <p>Now that you know [the basics](https://medium.com/swlh/beginners-guide-to-load-testing-with-k6-85ec614d2f0d) and have defined your [performance goals](https://medium.com/swlh/beginners-guide-to-load-testing-with-k6-73d55ee23723), it is now time to write your load-test...</p>
    </a>
  </div>


</div>
    </div>

    <div class="border-top-thin clearfix mt-2 mt-lg-4">
  <div class="container mx-auto px-2">
    <p class="col-8 sm-width-full left py-2 mb-0">This project is maintained by <a class="text-accent" href="https://github.com/mostafa">mostafa</a></p>
    <ul class="list-reset right clearfix sm-width-full py-2 mb-2 mb-lg-0">
      <li class="inline-block mr-1">
        <a href="https://twitter.com/share" class="twitter-share-button" data-hashtags="Mostafa's personal blog">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
      </li>
      <li class="inline-block">
        <a class="github-button" href="https://github.com/mostafa/" data-icon="octicon-star" data-count-href="mostafa//stargazers" data-count-api="/repos/mostafa/#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star mostafa/ on GitHub">Star</a>
      </li>
    </ul>
  </div>
</div>


  </body>

</html>
